<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Recipe for a Good Relationship</title>

<style>
:root{
  --fill: 0%;
}

html,body{
  margin:0;
  height:100%;
  background:#FFF3B0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
}

body{
  display:flex;
  justify-content:center;
  align-items:center;
}

.game{
  position:relative;
  width:100%;
  max-width:430px;
  aspect-ratio:9/16;
  background:url("./mock.png") center / contain no-repeat;
  overflow:hidden;
}

/* ---------- BOWL MASK ---------- */
svg{ position:absolute; width:0; height:0; }

.batter{
  position:absolute;
  bottom:34%;
  left:20%;
  width:60%;
  height:var(--fill);
  background:linear-gradient(
    180deg,
    #FFE6F3,
    #FF9FD2,
    #FF73B8
  );
  mask:url(#bowlMask);
  -webkit-mask:url(#bowlMask);
  transition:height 520ms cubic-bezier(.2,.9,.2,1);
  z-index:2;
}

/* ---------- INGREDIENTS ---------- */
.ingredients{
  position:absolute;
  bottom:4%;
  left:4%;
  right:4%;
  display:flex;
  justify-content:space-between;
  z-index:5;
}

.ingredient{
  width:56px;
  height:56px;
  background:#fff;
  border-radius:18px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:26px;
  cursor:pointer;
  box-shadow:0 10px 0 rgba(0,0,0,.08);
  transition:transform .15s;
}

.ingredient.used{
  opacity:.4;
  pointer-events:none;
}

.ingredient:active{
  transform:scale(.95);
}

/* ---------- CAKE ---------- */
.cake{
  position:absolute;
  left:50%;
  bottom:32%;
  transform:translateX(-50%) scale(0);
  width:180px;
  z-index:6;
  transition:transform 420ms cubic-bezier(.2,.95,.2,1);
}

.cake.show{
  transform:translateX(-50%) scale(1.1);
}

/* ---------- MESSAGE ---------- */
.message{
  position:absolute;
  left:50%;
  top:42%;
  transform:translateX(-50%) scale(.6);
  font-size:34px;
  font-weight:900;
  color:#FF73B8;
  -webkit-text-stroke:8px white;
  text-align:center;
  line-height:1.05;
  opacity:0;
  z-index:20;
}

.message.show{
  animation:pop 700ms cubic-bezier(.2,.95,.2,1) forwards;
}

@keyframes pop{
  0%{opacity:0;transform:translateX(-50%) scale(.6)}
  60%{opacity:1;transform:translateX(-50%) scale(1.15)}
  100%{opacity:1;transform:translateX(-50%) scale(1)}
}

/* ---------- CONFETTI ---------- */
canvas{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:30;
}
</style>
</head>

<body>

<div class="game">

  <!-- bowl mask -->
  <svg>
    <mask id="bowlMask">
      <rect width="100%" height="100%" fill="black"/>
      <ellipse cx="50%" cy="60%" rx="42%" ry="18%" fill="white"/>
    </mask>
  </svg>

  <!-- batter -->
  <div class="batter" id="batter"></div>

  <!-- cake -->
  <img src="./mock.png" class="cake" id="cake" alt="cake">

  <!-- message -->
  <div class="message" id="message">
    I‚Äôm sorry.<br>I love you
  </div>

  <!-- ingredients -->
  <div class="ingredients">
    <div class="ingredient" data-i>üçì</div>
    <div class="ingredient" data-i>üçØ</div>
    <div class="ingredient" data-i>ü•õ</div>
    <div class="ingredient" data-i>üçã</div>
    <div class="ingredient" data-i>üßà</div>
    <div class="ingredient" data-i>üßÇ</div>
  </div>

  <canvas id="confetti"></canvas>
</div>

<script>
const ingredients = document.querySelectorAll("[data-i]");
const batter = document.getElementById("batter");
const cake = document.getElementById("cake");
const message = document.getElementById("message");
const canvas = document.getElementById("confetti");
const ctx = canvas.getContext("2d");

let count = 0;
const total = ingredients.length;

ingredients.forEach(i=>{
  i.onclick = ()=>{
    if(i.classList.contains("used")) return;
    i.classList.add("used");
    count++;
    batter.style.setProperty("--fill", `${(count/total)*18}%`);
    if(count === total) bake();
  };
});

function bake(){
  cake.classList.add("show");
  cake.onclick = finale;
}

function finale(){
  message.classList.add("show");
  confetti();
}

function confetti(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
  const pieces = Array.from({length:140},()=>({
    x:innerWidth/2,
    y:innerHeight/2,
    vx:(Math.random()-0.5)*10,
    vy:(Math.random()-0.8)*12,
    g:.25,
    r:Math.random()*6+3,
    c:["#FF73B8","#FFD67A","#A88BFF","#78C8FF","#8FF2C8"][Math.floor(Math.random()*5)]
  }));

  let t=0;
  (function loop(){
    t++;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    pieces.forEach(p=>{
      p.vy+=p.g;
      p.x+=p.vx;
      p.y+=p.vy;
      ctx.fillStyle=p.c;
      ctx.fillRect(p.x,p.y,p.r,p.r);
    });
    if(t<90) requestAnimationFrame(loop);
  })();
}
</script>

</body>
</html>
